function [out] = datagen_antigenic_sin(timepoints, theta)
mu = theta(1); % 均值-15.5
sigma = theta(2); % 标准差 0.5
k2 = 1;
k4 = 0.01;
k3 = 0.5;
k_1 = 1;

new_distribution  = [2.86905884497322e-08;8.82087938857935e-06;0.000612666007857781;0.00995271067353384;0.0394723916270296;0.0394695920313488;0.00995265310147802;0.000612672521941623;1.80565452599897e-05;7.46173506625253e-08;0.0455081795174438;13.9913820188684;971.766453075960;15784.9569228328;62595.1936216280;62594.6995888966;15783.9863999999;971.616891830023;13.9888483427713;0.0454997954417979;1463.27428094536;449867.058650107;31237727.9903454;506990947.260280;2009516296.92736;2009357992.87693;506679377.394506;31189704.5212150;449053.550581707;1460.58071221969;1067109.86831275;327976251.475613;22719075989.6756;365704685578.229;1442655569817.68;1441519697643.63;363466322751.239;22373759052.1130;322125789.677652;1047738.52803558;26183827.7048865;8027308537.59289;544292425022.426;8113264099715.24;30546691345453.2;30307260636672.2;7636021994419.91;470012574967.457;6766947230.44926;22009990.5062894;75173344.2358081;22797815622.0717;1402309710117.62;13162987894945.2;33036219229462.1;30558773767931.3;7642368497990.36;470051645863.358;6767003444.73155;22010009.0684961;146172373.869388;43808113533.8100;2402112030678.91;9393456253327.45;3228067012246.12;1579067811968.40;366831433761.143;22394410183.0043;322155521.293193;1047748.48745483;807304416.845646;240373509647.817;12352409601060.1;26445172909214.9;326475967009.541;4733232138.54345;555317110.918086;31478889.7557314;449469.790658780;1460.72023498792;3691582917.43008;1094974601774.60;54725558592692.3;92672914041650.2;267155511898.451;16688697.3008308;37392.8362982259;1064.96641448684;14.1067924016387;0.0455432683362406;2762728004.56012;815960257022.813;38778241947212.2;45690911024843.2;47015427001.3656;466277.084139520;2.82259753440014;0.00145264960903703;9.67096977166729e-06;0.000129121783536480];

prob_A(1) = normcdf(theta(1)-4, mu, sigma);
% 计算累积分布概率
for i = 2:5
prob_A(i) = normcdf(theta(1)-4+i-1, mu, sigma) - normcdf(theta(1)-4+i-2, mu, sigma);
end
for i = 6:10
prob_A(i) = prob_A(11-i);
end


mu_2 = 1.5; % 均值
sigma_2 = 0.8; % 标准差


prob_B(1) = normcdf(-2.5, mu_2, sigma_2);
% 计算累积分布概率
for i = 2:5
prob_B(i) = normcdf(-2.5+i-1, mu_2, sigma_2) - normcdf(-2.5+i-2, mu_2, sigma_2);
end
for i = 6:10
prob_B(i) = prob_B(11-i);
end

total_B = 1e15;

for i = 1:10
    for j = 1:10
        x0(10*(i-1)+j) = prob_A(i)*prob_B(j)*total_B*0.99999 + 1e-8*new_distribution(10*(i-1)+j);
    end
end
x0(101) = 1e2;%% virus

for i = 1:10
    for j = 1:10
        x0(10*(i-1)+j+101) = 0;
    end
end

x0(202) = 1e16;%% environmental antigen concentration

for i = 1:10
    for j = 1:10
        x0(10*(i-1)+j+202) = x0(10*(i-1)+j)*k4/(k2-k3);
    end
end

% x0(1) = 1e8;% antibody 1
% x0(2) = 1e14;% antibody 2
% x0(3) = 1e2;% virus
% x0(4) = 0;% antibody-1-virus complex
% x0(5) = 0;% antibody-2-virus complex


para(1) = 10^(theta(1)-4.5); 
para(2) = 10^(theta(1)-3.5); 
para(3) = 10^(theta(1)-2.5); 
para(4) = 10^(theta(1)-1.5); 
para(5) = 10^(theta(1)-0.5);  
para(6) = 10^(theta(1)+0.5); 
para(7) = 10^(theta(1)+1.5);  
para(8) = 10^(theta(1)+2.5); 
para(9) = 10^(theta(1)+3.5);  
para(10) = 10^(theta(1)+4.5); 

para_new(1) = 1e-3; 
para_new(2) = 1e-2;
para_new(3) = 1e-1; 
para_new(4) = 1e0;
para_new(5) = 1e1; 
para_new(6) = 1e2;
para_new(7) = 1e3; 
para_new(8) = 1e4;
para_new(9) = 1e5; 
para_new(10) = 1e6;


para(11) = 0.01;
para(12) = theta(3);%% 5
para(13) = theta(4);%% 1
para(14) = theta(5);%% 0.5
para(15) = 1;
para(16) = 0.01*10.5/0.5*1e-16;
para(17) = 10;
para(18) = 1e13;

% para(2) = 1e-15; 
% para(3) = 1; 
% para(4) = 0.01; 
% para(5) = 5;
% para(6) = 1;
% para(7) = 0.5;
% para(8) = 1;

[t,y]=ode15s(@pathway_model_many_antibody_immune_res_new,[0 200],x0,[],para,para_new);

for i = 1:100
data_new_2(i,:) = interp1(t,y(:,i),(0:1:200));
end

for k = 1:length(timepoints)


for i = 1:100
    x0(i) = data_new_2(i,timepoints(k)+1);
end

x0(101) = 1e16;%% virus

for i = 1:10
    for j = 1:10
        x0(10*(i-1)+j+101) = 0;
    end
end

x0(202) = 0;%% environmental antigen concentration

for i = 1:10
    for j = 1:10
        x0(10*(i-1)+j+202) = x0(10*(i-1)+j)*k4/(k2-k3);
    end
end

% x0(1) = 1e8;% antibody 1
% x0(2) = 1e14;% antibody 2
% x0(3) = 1e2;% virus
% x0(4) = 0;% antibody-1-virus complex
% x0(5) = 0;% antibody-2-virus complex


para_2(1) = 10^(theta(1)-4.5); 
para_2(2) = 10^(theta(1)-3.5); 
para_2(3) = 10^(theta(1)-2.5); 
para_2(4) = 10^(theta(1)-1.5); 
para_2(5) = 10^(theta(1)-0.5);  
para_2(6) = 10^(theta(1)+0.5); 
para_2(7) = 10^(theta(1)+1.5);  
para_2(8) = 10^(theta(1)+2.5); 
para_2(9) = 10^(theta(1)+3.5);  
para_2(10) = 10^(theta(1)+4.5); 

para_new(1) = 1e-3; 
para_new(2) = 1e-2;
para_new(3) = 1e-1; 
para_new(4) = 1e0;
para_new(5) = 1e1; 
para_new(6) = 1e2;
para_new(7) = 1e3; 
para_new(8) = 1e4;
para_new(9) = 1e5; 
para_new(10) = 1e6;


para_2(11) = 0;%% 0.01
para_2(12) = 0;%% 5
para_2(13) = 0;%% 1
para_2(14) = 0;%% 0.5
para_2(15) = 1;
para_2(16) = 0.01*10.5/0.5*1e-16;
para_2(17) = 10;
para_2(18) = 0;

% para(2) = 1e-15; 
% para(3) = 1; 
% para(4) = 0.01; 
% para(5) = 5;
% para(6) = 1;
% para(7) = 0.5;
% para(8) = 1;

[t, zz]=ode15s(@pathway_model_many_antibody_immune_res_new,[0 10],x0,[],para_2,para_new);

out(k) = 1e16-interp1(t,zz(:,101),10);

end



end